<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jose Eduardo Meireles, Anna K. Schweiger" />

<meta name="date" content="2016-11-17" />

<title>Introduction to spectrolab</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Introduction to spectrolab</h1>
<h4 class="author"><em>Jose Eduardo Meireles, Anna K. Schweiger</em></h4>
<h4 class="date"><em>2016-11-17</em></h4>



<p>The goal of <code>spectrolab</code> is to provide essential functions to process data from portable spectrometers and a common interface for spectra that other packages can build on. Currently <code>spectrolab</code> has been only tested for SVC data (Spectral Vista Inc.). <code>spectrolab</code> provides methods to read spectral data files, to perform jump correction, vector normalization, smoothing at the sensor overlap regions, and to filter out bad measurements. <code>spectrolab</code> introduces the S3 class <code>spectra</code>, which makes it easy to plot and manipulate data and to access additional metadata.</p>
<div id="installing-and-loading-spectrolab" class="section level2">
<h2>Installing and loading <code>spectrolab</code></h2>
<p>The best way to get <code>spectrolab</code> is to install it directly from the <a href="www.github.com/annakat/spectrolab"><em>github repository</em></a>. You will need the <code>devtools</code> package to do it.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;devtools&quot;</span>)
<span class="kw">install_github</span>(<span class="st">&quot;annakat/spectrolab&quot;</span>)</code></pre></div>
<p>Assuming that everything went smoothly, you should be able to load <code>spectrolab</code> like any other package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;spectrolab&quot;</span>)</code></pre></div>
</div>
<div id="reading-spectra" class="section level2">
<h2>Reading spectra</h2>
<p>Assume you have a directory with several .sig files, an example can be found in the folder <code>Acer_example</code>. During your measurment campaign you might have flagged filenames of obviously bad measurements with “bad” and white reference measurements with “WR”, but don’t worry if you have not. We can take care of filtering out bad and reference measurements later.</p>
<div id="reading-raw-spectra-example-with-.sig-files" class="section level3">
<h3>Reading raw spectra: example with <code>.sig</code> files</h3>
<p>You can read raw spectra files using the function <code>read_spectra()</code>. As of now, only files in the <code>.sig</code> (Spectra Vista) can be read direcly, but other formats are in the works. You can pass a vector of filenames to <code>read_spectra()</code>, but it is usually easier to pass the path for the folder where all your data is.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dir_path is the directory where our example datasets live</span>
dir_path =<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Acer_example&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spectrolab&quot;</span>)

<span class="co"># read .sig files</span>
acer_spectra =<span class="st"> </span><span class="kw">read_spectra</span>(<span class="dt">path =</span> dir_path, <span class="dt">format =</span> <span class="st">&quot;sig&quot;</span>)

<span class="co"># Note that `acer_spectra` is a `spectra` object. You can ensure that is true</span>
<span class="co"># using spectrolab's `is_spectra()` function.</span>

<span class="kw">is_spectra</span>(acer_spectra)</code></pre></div>
<p>You can inspect the newly read data <code>acer_spectra</code> in several ways. You may want to know how many spectra and how many bands are in there or may want to plot them.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># simply print the object</span>
acer_spectra

<span class="co"># Get a vector with the dataset dimension.</span>
<span class="kw">dim</span>(acer_spectra)

<span class="co"># and plot the spectra</span>
<span class="kw">plot</span>(acer_spectra)</code></pre></div>
</div>
<div id="create-spectra-from-a-matrix" class="section level3">
<h3>Create spectra from a matrix</h3>
<p>If you already have your spectra in a matrix, you can use the function <code>as.spectra()</code> to convert it to a <code>spectra</code> object. The matrix <strong>must</strong> be in a very specific format, so <strong>read carefully!</strong>. Samples must be in rows and wavelengths in columns. The first column must be a sample label, i.e. a species name. Column names must be the wavelength labels. We included an example of a matrix like that names <code>spec_matrix_example</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spec =<span class="st"> </span>spec_matrix_example

<span class="co"># Check out the format of the matrix</span>
spec[<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">1</span>:<span class="dv">4</span>]

<span class="co"># To convert it to spectra, simply run:</span>
spec_from_matrix =<span class="st"> </span><span class="kw">as.spectra</span>(spec)

<span class="co"># And again you can plot it to make sure erything worked ok</span>
<span class="kw">plot</span>(spec)</code></pre></div>
<p>You see that the sensor overlap regions were preserved when the data was acquired, resulting in duplicated wavelenghts and a “jump” between the VIS/NIR and NIR/SWIR regions. To construct a <code>spectra</code> object, you need to first run the jump corrector by calling <code>jump_corr()</code>.</p>
</div>
<div id="jump-correction" class="section level3">
<h3>Jump correction</h3>
<p>The jump corrector removes the VIS/NIR and NIR/SWIR overlap regions. In principle, the algorithm searches for the wavelengths of closest approach in both overlap regions, cuts the spectrum into three pieces, removes the overlap and finds a multiplier to paste the junks back together. As a convention, the NIR regions is left unchanged.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># The function `jump_corr()` reads raw data, so there is no need for running `read_spec` fist. Similar to `read_spec` you only need to point `jump` to the folder containing your .sig files. </span>

myfolder &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;Acer_example&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;spectrolab&quot;</span>)
Acer_juco &lt;-<span class="st"> </span><span class="kw">jump_corr</span>(myfolder, <span class="dt">filename =</span> T)</code></pre></div>
</div>
<div id="smoothing-at-overlap-regions" class="section level3">
<h3>Smoothing at overlap regions</h3>
<p>Depending on your analysis, it can be a good idea to smooth remaining noise at the sensor overlap regions. <code>smoo.visnir.svc</code> uses a moving average between 970 - 1025 nm. <code>smoo.nirswir.svc</code> uses linear interpolation between 1903 - 1917 nm. Note that we DO NOT use additional smoothing when predicting traits from spectra with PLSR models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Smooth only VIS/NIR or NIR/SWIR
Acer_smoo1 &lt;-<span class="st"> </span><span class="kw">smoo.visnir.svc</span>(Acer_juco)
Acer_smoo2 &lt;-<span class="st"> </span><span class="kw">smoo.nirswir.svc</span>(Acer_juco)

### Smooth both regions
Acer_smoo &lt;-<span class="st"> </span><span class="kw">smoo.nirswir.svc</span>(Acer_smoo1)
### Same result
Acer_smoo &lt;-<span class="st"> </span><span class="kw">smoo.visnir.svc</span>(Acer_smoo2)</code></pre></div>
</div>
<div id="constructing-a-spectra-object" class="section level3">
<h3>Constructing a <code>spectra</code> object</h3>
<p>The <code>spectra</code> class holds the essential information used in spectral dataset: reflectance, wavelengths, etc. The class has a bunch of requirements in terms of both format and values. For instance, relative reflectance must be between 0 and 1 and wavelengths can not be duplicated.</p>
<p>If your data is in a matrix or data.frame with the same format as <code>Acer_juco</code> or <code>Acer_smoo</code> (check previous section for details), you can construct a <code>spectra</code> object by calling the <code>as.spectra()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make a spectra object if you have a matrix in the right format</span>
<span class="co"># Here we remove the first column containing the filename</span>
spec &lt;-<span class="st"> </span>spectrolab::<span class="kw">as.spectra</span>(Acer_juco[,-<span class="dv">1</span>])

<span class="co"># Did it work?</span>
<span class="kw">is_spectra</span>(spec)</code></pre></div>
<p>Alternativelly, you can create a <code>spectra</code> object using the more flexible <code>spectra()</code> constructor, which takes three arguments: (1) a reflectance matrix, (2) a vector of wavelengths and (3) the sample names.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># (1) Create a reflectance matrix.</span>
<span class="co">#     In this case, by removing the sample ID column</span>
rf &lt;-<span class="st"> </span>Acer_juco[, -<span class="dv">1</span>]

<span class="co"># Check the result</span>
rf[<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">1</span>:<span class="dv">3</span>]

<span class="co"># (2) Create a vector with wavelength labels that match</span>
<span class="co">#     the reflectance matrix columns.</span>
wl &lt;-<span class="st"> </span><span class="kw">colnames</span>(rf)

<span class="co"># Check the result</span>
wl[<span class="dv">1</span>:<span class="dv">4</span>]

<span class="co"># (3) Create a vector with sample labels that match</span>
<span class="co">#     the reflectance matrix rows.</span>
<span class="co">#     In this case, use the first colum of spec_matrix_example</span>
sn &lt;-<span class="st"> </span>Acer_juco[, <span class="dv">1</span>] 

<span class="co"># Check the result</span>
sn[<span class="dv">1</span>:<span class="dv">4</span>]

<span class="co"># Finally, construct the spectra object using the `spectra` constructor</span>
spec &lt;-<span class="st"> </span><span class="kw">spectra</span>(<span class="dt">reflectance =</span> rf, <span class="dt">wavelengths =</span> wl, <span class="dt">names =</span> sn)

<span class="co"># And hopefully this worked fine</span>
<span class="kw">is_spectra</span>(spec)</code></pre></div>
<p>You can explore your <code>spectra</code> using <code>plot()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(spec)</code></pre></div>
</div>
</div>
<div id="plotting" class="section level2">
<h2>Plotting</h2>
<p>The workhorse function for plotting <code>spectra</code> is <code>plot()</code>. It will jointly plot each spectrum in the <code>spectra</code> object. You should be able to pass the usual plot arguments to it, such as <code>col</code>, <code>ylab</code>, etc.</p>
<p>You can also plot the quantile of a <code>spectra</code> object with <code>plot_quantile()</code>. It’s second argument, <code>total_prob</code>, is the total “mass” that the quantile encompasses. For instance, a <code>total_prob = 0.95</code> covers 95% of the variation in the <code>spectra</code> object; i.e. it is the <code>0.025 to 0.975</code> quantile. The quantile plot can stand alone or be added to a current plot if <code>add = TRUE</code>.</p>
<p>Last but not least, you can also shade spectral regions with the <code>plot_spec_regions()</code> function. <code>spectrolab</code> provides a <code>default_spec_regions()</code> matrix as an example, but you obviously can customize it for your needs.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simple spectra plot</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))
<span class="kw">plot</span>(spec, <span class="dt">lwd =</span> <span class="fl">0.75</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;grey25&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;All Spectra&quot;</span>)

<span class="co"># Stand along quantile plot</span>
<span class="kw">plot_quantile</span>(spec, <span class="dt">total_prob =</span> <span class="fl">0.8</span>, <span class="dt">main =</span> <span class="st">&quot;80% spectral quantile&quot;</span>, 
              <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="dt">lwd =</span> <span class="fl">0.5</span>, <span class="dt">border =</span> <span class="ot">TRUE</span>)

<span class="co"># Combined quantile and individual spctra plot</span>
<span class="co"># With an added bonus of shading 4 spectral regions</span>
<span class="kw">plot</span>(spec, <span class="dt">lwd =</span> <span class="fl">0.25</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;grey50&quot;</span>, <span class="st">&quot;Spectra, quantile and regions&quot;</span>)
<span class="kw">plot_quantile</span>(spec, <span class="dt">total_prob =</span> <span class="fl">0.8</span>, 
              <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.25</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">border =</span> <span class="ot">FALSE</span>)
<span class="kw">plot_spec_regions</span>(spec, <span class="dt">regions =</span> <span class="kw">default_spec_regions</span>(), <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAwAAAADwCAYAAAC3+wMKAAAEDWlDQ1BJQ0MgUHJvZmlsZQAAOI2NVV1oHFUUPrtzZyMkzlNsNIV0qD8NJQ2TVjShtLp/3d02bpZJNtoi6GT27s6Yyc44M7v9oU9FUHwx6psUxL+3gCAo9Q/bPrQvlQol2tQgKD60+INQ6Ium65k7M5lpurHeZe58853vnnvuuWfvBei5qliWkRQBFpquLRcy4nOHj4g9K5CEh6AXBqFXUR0rXalMAjZPC3e1W99Dwntf2dXd/p+tt0YdFSBxH2Kz5qgLiI8B8KdVy3YBevqRHz/qWh72Yui3MUDEL3q44WPXw3M+fo1pZuQs4tOIBVVTaoiXEI/MxfhGDPsxsNZfoE1q66ro5aJim3XdoLFw72H+n23BaIXzbcOnz5mfPoTvYVz7KzUl5+FRxEuqkp9G/Ajia219thzg25abkRE/BpDc3pqvphHvRFys2weqvp+krbWKIX7nhDbzLOItiM8358pTwdirqpPFnMF2xLc1WvLyOwTAibpbmvHHcvttU57y5+XqNZrLe3lE/Pq8eUj2fXKfOe3pfOjzhJYtB/yll5SDFcSDiH+hRkH25+L+sdxKEAMZahrlSX8ukqMOWy/jXW2m6M9LDBc31B9LFuv6gVKg/0Szi3KAr1kGq1GMjU/aLbnq6/lRxc4XfJ98hTargX++DbMJBSiYMIe9Ck1YAxFkKEAG3xbYaKmDDgYyFK0UGYpfoWYXG+fAPPI6tJnNwb7ClP7IyF+D+bjOtCpkhz6CFrIa/I6sFtNl8auFXGMTP34sNwI/JhkgEtmDz14ySfaRcTIBInmKPE32kxyyE2Tv+thKbEVePDfW/byMM1Kmm0XdObS7oGD/MypMXFPXrCwOtoYjyyn7BV29/MZfsVzpLDdRtuIZnbpXzvlf+ev8MvYr/Gqk4H/kV/G3csdazLuyTMPsbFhzd1UabQbjFvDRmcWJxR3zcfHkVw9GfpbJmeev9F08WW8uDkaslwX6avlWGU6NRKz0g/SHtCy9J30o/ca9zX3Kfc19zn3BXQKRO8ud477hLnAfc1/G9mrzGlrfexZ5GLdn6ZZrrEohI2wVHhZywjbhUWEy8icMCGNCUdiBlq3r+xafL549HQ5jH+an+1y+LlYBifuxAvRN/lVVVOlwlCkdVm9NOL5BE4wkQ2SMlDZU97hX86EilU/lUmkQUztTE6mx1EEPh7OmdqBtAvv8HdWpbrJS6tJj3n0CWdM6busNzRV3S9KTYhqvNiqWmuroiKgYhshMjmhTh9ptWhsF7970j/SbMrsPE1suR5z7DMC+P/Hs+y7ijrQAlhyAgccjbhjPygfeBTjzhNqy28EdkUh8C+DU9+z2v/oyeH791OncxHOs5y2AtTc7nb/f73TWPkD/qwBnjX8BoJ98VVBg/m8AAEAASURBVHgB7F0J3EzVG37t+76EUEiWREQpKVuU1J8WKZREpCLtaZU2rdq0p1LaU5ZSlMiSUkQREQlJ9n3//u9z6k7zzTd3vlnuzNx753n9xjdzl3PPec499777mydLSUhEgAgQASJABIgAESACRIAIZAQCeTNilBwkESACRIAIEAEiQASIABEgAgYBCgC8EYgAESACRIAIEAEiQASIQAYhQAEggyabQyUCRIAIEAEiQASIABEgAhQAeA8QASJABIgAESACRIAIEIEMQoACQAZNNodKBIgAESACRIAIEAEiQAQoAPAeIAJEgAgQASJABIgAESACGYQABYAMmmwOlQgQASJABIgAESACRIAIUADgPUAEiAARIAJEgAgQASJABDIIAQoAGTTZHCoRIAJEgAgQASJABIgAEaAAwHuACBABIkAEiAARIAJEgAhkEAIUADJosjlUIkAEiAARIAJEgAgQASJAAYD3ABEgAkSACBABIkAEiAARyCAEKABk0GRzqESACBABIkAEiAARIAJEgAIA7wEiQASIABEgAkSACBABIpBBCFAAyKDJ5lCJABEgAkSACBABIkAEiAAFAN4DRIAIEAEiQASIABEgAkQggxCgAJBBk82hEgEiQASIABEgAkSACBABCgC8B4gAESACRIAIEAEiQASIQAYhQAEggyabQyUCRIAIEAEiQASIABEgAhQAeA8QASJABIgAESACRIAIEIEMQoACgEcn+9ChQ7Jp0ybZtm1bjhHs3bvX7Nu/f79kZWWZ7zt37sxxXPCGVatWyU8//SS5HRd8Dr8TASJABIgAESACRIAIeA8BCgDemzPT47feekvKlSsnlSpVks2bN2cbxYsvvmj2TZw4UdavX2++X3HFFdmOsX5MmTLFtHHEEUfIsccea469/fbbrd1J+7tlyxYZPHiwbN26NWnXYMNEgAgQASJABIgAESACORGgAJATE09sefnll00/d+/eLaNHj46rz/v27ZNzzz1X8ufPL4899pg899xzUq1aNbnvvvtk3LhxcbUZ7Un9+vWTESNGCCwZJCJABIgAESACRIAIEIHUIUABIHVYO3al5cuXy1dffSWdOnWSIkWKyAsvvBBX2ytXrpTt27dL3bp1ZcCAAQKmHILFwIEDpXDhwqbNyZMnm99wD7rpppuke/fuAsuCRXAxgsWhW7ducvXVV8uPP/5o7TJ/x44dK7169ZL+/fvLBx98YFyS0Ob3339v9t9yyy3y66+/yqRJk8x1pk2bZq4xZswYs3/8+PEyaNAg0/7QoUMFlgMSESACRIAIEAEiQASIQPwIUACIH7u0nQkmHYz3VVddJV26dJGff/5ZZs6cGXN/jjrqKGnYsKF88cUXUrlyZbnooouMy9ADDzwg7du3N+3NnTtXnnrqKWnTpo1MnTpVPv74YyN4zJo1y+yHGw/cixBDMGHCBDnxxBNl3rx5Zt+jjz5qLAw4D+2cf/758vzzz5tjN2zYYI5BO2Dq58yZY65zzjnnyGeffSZ//fWXEQrw+9tvvzVuTnfffbf07t3bnMf/iAARIAJEgAgQASJABOJDgAJAfLil7ayDBw/Kq6++avz2Tz/9dLn00ktNX8BYx0p58+Y1TDaYarjivP3223LBBRfIMcccI8uWLcvWHLZ/99138s0335jt7733ngkufvrpp6Vly5YCRh6M+oEDB+SRRx4xxwwbNszEFMBigXOhycc1L7/8cmnbtq05Zvr06dKsWbPAtSBMQDiANQECyptvvik4BkIPhJQFCxYEjuUXIkAEiAARIAJEgAgQgdgRoAAQO2ZpPeOTTz6RP//8U4oVKybXXHONcavJkyePgCEPDQaOpqPFixeXkSNHyt9//20YbVgB4Bp0//33Zzu9Xbt25neDBg3ksMMOM9p+CAkQSBYuXCh16tQxggD6smTJElm3bp0J8D3hhBNMjAG2w+ffLhjZuthpp51mvhYoUEDKly9vBAcIJDVr1pSNGzcyS5EFFP8SASJABIgAESACRCBOBCgAxAlcuk576aWXzKWhJYef/DvvvGPiAPbs2SOvv/56TN366KOPpGTJknLbbbcJGG5o8uH+A4LWPpjgZgRCzAAYccQe1K5dW/Lly2c0+Lg2PnAngra+dOnSRtu/dOnSQDNvvPGGICYABIEABFemYIJAYlGfPn2MW9A999xjhBsIGbAgkIgAESACRIAIEAEiQATiR4DcVPzYpfxMaP5hAUC6TvjNWx+4xYChjjUYGP71YKqfeeYZ45YDrX/nzp3NuDp06JBtfMgQBMYerjlw8+nYsaOUKVNGmjdvbvz3YTWACxBiBb788ksTRIw4AggSN954o7kGgoERCAyCAAGCiw/iByyCQGER6hwgQ1H16tVNVqLFixfLrl27rN38SwSIABEgAkSACBABIhAHAvnjOIenpAmB1157zTDfPXv2zNaDWrVqCVxnkBloxowZ2fZF+gFtOuIJnnzySaOZhwtRqVKl5LrrrpObb74526lg5pEdCAz4WWedZawGOACxB8gAhE/RokVNUDIyCoGQHahHjx4mJgBZhSBUDB8+3OyD8IFaBmizSpUqZlvof0OGDDEuQy1atDDBynBDQoDwH3/8YdKVhh7P30SACBABIkAEiAARIAK5I5BHXTCy+2Dkfg6P8CEC0OojDgCBtsEElyAw4igYBhchuAChAFkoQXiAAFCoUKHQXSYWAC5G2B9MqGKM2w9CRyRCvypUqBDpEO4jAkSACBABIkAEiAARiBIBWgCiBMrvh8HVJpT5Dx1zwYIFwzL/OA7uQHZkx+Aj/iAaIvMfDUo8hggQASJABIgAESAC0SHAGIDocMrYo6D1R/59ZOEhEQEiQASIABEgAkSACHgfAboAeX8OOQIiQASIABEgAkSACBABIhA1ArQARA0VDyQCRIAIEAEiQASIABEgAt5HgAKA9+eQIyACRIAIEAEiQASIABEgAlEjQAEgaqh4IBEgAkSACBABIkAEiAAR8D4CFAC8P4ccAREgAkSACBABIkAEiAARiBoBCgBRQ8UDiQARIAJEgAgQASJABIiA9xGgAOD9OeQIiAARIAJEgAgQASJABIhA1AhQAIgaKh5IBIgAESACRIAIEAEiQAS8jwAFAO/PIUdABIgAESACRIAIRIHAk08+KU888USOI/v06SPfffed/Pjjj9KrV6/A/tdff11OPvlkqVWrlnTp0kV+/fXXwD6nv/z2229y0kknycqVKwNNHzhwQE499VTzO7hvH3/8sZx44omBT/v27eWGG26QnTt3Bs5N1hfghOvVqFFD2rRpI5988om51PPPPy/PPPNM4LJTp041/Vu9enVg29VXXy2zZs2S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CFAA8PT0sfNEgAgQASJABIgAESACRCA2BCgAxIYXjyYCRIAIEAEiQASIABEgAp5GgAKAp6ePnScCRIAIEAEiQASIABEgArEhQAEgNrx4NBEgAkSACBABIkAEiAAR8DQCFAA8PX3sPBEgAkSACBABIkAEiAARiA0BCgCx4cWjiQARIAJEgAgQASJABIiApxGgAODp6WPniQARIAJEgAgQASJABIhAbAhQAIgNLx5NBIgAESACRIAIEAEiQAQ8jQAFAE9PHztPBIgAESACRIAIEAEiQARiQ4ACQGx48WgiQASIABEgAkSACBABIuBpBCgAeHr62HkiQASIABEgAkSACBABIhAbAhQAYsOLRxMBIkAEiAARIAJEgAgQAU8jQAHA09PHzhMBIkAEiAARIAJEgAgQgdgQoAAQG16uO3rv3r1y8803Z+vX7bffLtOnTw9smzJlinzyySeB34l8+fDDD+WHH35IpIls5+7evVvWr19vtj366KOyefPmbPv5gwgQAXsEuP7tseEeIuB3BLj+/T7DyR0fBYDk4pv01gsVKiTjx4+XpUuXmmv9+uuv8uqrr8rIkSMD137hhRfkwIEDgd+JfJk6dar88ssviTSR7dxrrrlG5s6da7aNGTNGtm3blm0/fxABImCPANe/PTbcQwT8jgDXv99nOLnjy5/c5tl6KhBo27atzJgxQ44++miZNGmSDB48WJ5++mk5ePCg5MuXT2bPni0vv/yy6cp7770nc+bMkVKlSknv3r1l3759hgG/4IILzP4FCxYYjXy7du1k1apVMnr0aGnevLm0adNG8uTJk20427dvN/uLFy8uF154oeBhBAHkjz/+kGXLlpkPth9//PHmvHHjxsm8efPMdSdOnGjahDUBwkmjRo3MMZs2bZJ3331XihYtKv379zf9z3ZR/iACRCAbAlz/2eDgDyKQUQhw/WfUdDs6WFoAHIUzPY2BWZ85c6a5OASAs846Sxo3bizffvutLFmyRGrUqCElSpSQxx9/XN5++23p3Lmz7Ny5U7p37y4VK1aU66+/XmBKBD3wwAOyf/9+mTZtmnTr1s0w72DWr776arPf+m/Hjh3StGlTKVu2rOD7aaedZnbBOnDuueeaNtCHM888U+Dm88orr5jrn3DCCTJo0CAZOnSolCtXTipUqCD169eXkiVLmvPvuusuadiwoUBYQH9JRIAIREaA6z8yPtxLBPyMANe/n2c3uWOjAJBcfFPSeqtWreSbb74xTPyKFSukbt260v7/7d0/SyNBGMfx5wQFsRIC/kMbBQnYWmlj4R8ESWGaiIidqO/Bxk5BbATfgZWIYOW7EAUrCytbbSyN93tgZI05PSU7GZPvwN3mdjc7u59xZJ7dZ/bm5ky5/5oLoM8qKysrdnx87HfXBwcH7f7+3np6emx2dtY0yFf6jdJxtP/JyYktLi5aZ2enLy8vL9+lEV1cXPhAXQP48fFxv/t/dXXl9RSLRdve3rZKpWJDQ0P28PDgAcDu7q4HBAoy9HRCAUBfX59NTEx4gKIvKwCYn5+3zc1N09MICgIIfC5A///ch60ItLIA/b+VWzffayMFKF/fKEdXOo/+nJ2d2fT0tNepQbQG4RpkK89eRU8H9vb2TL8wNOh+eXnx9UoFOjg4sKenJyuXy552c3Nz4yk/Si1SWV1dtcfHR/+sv7Rdd/7DdqUI6cmBigKQUJQWpMG+njj09/f76oGBAevoqB97FgoF30eBSTheOBZLBBD4KED//2jCGgTaRYD+3y4t3fjrrD8Ka3w9HDFnAeUB7u/v28LCgtektB/l09/e3nqqjlZqYrBScY6OjmxkZMQH5lo/NTVld3d3Pk9gfX1dq6xUKtnw8LDfkVf6j3L79YsmFG1XALGzs+P76C5/b29v2PxhubS0ZJp/oHJ6evoWfOgJgwIECgII/FyA/v9zO76JwG8XoP//9hZszvkTADTHveG1Kg9QKTP6RRDK5OSkjY6Ovt1t39jY8KcBy8vLdn5+7rs9Pz/7UpN1q9Wqp/NoxdramgcPSg/S4F2BhQbroejYyvHX04SZmRnr7u72usL22uXW1panJGkOgIISTfJV0XGU7hOeJNR+j38jgMDXAvT/r43YA4FWFaD/t2rL5ntdf/4O+qr5VsHRUxLQW3+UWqMUm/8pChA0uK99A1D4ro6lH6Gurq6wqu5S/w+B0o705OH6+trfVKQ5CiqagKzv/6uOugdkJQIIfFuA/v9tMr6AQMsI0P9bpikbciHMAWgI4+85iAbaXw3Ws1cT7tRn12U/Z58KZNfXflbAobcD6XWfeg3p4eHh2y6aJ0BBAIH8Bej/+RtTAwKpCtD/U22Z5pwXTwCa496Wtep9/5pLMDY29i6dqC0xuGgE2kyA/t9mDc7lIpARoP9nMBL5SACQSENwGggggAACCCCAAAIIxBBgEnAMZepAAAEEEEAAAQQQQCARAQKARBqC00AAAQQQQAABBBBAIIYAAUAMZepAAAEEEEAAAQQQQCARAQKARBqC00AAAQQQQAABBBBAIIYAAUAMZepAAAEEEEAAAQQQQCARAQKARBqC00AAAQQQQAABBBBAIIYAAUAMZepAAAEEEEAAAQQQQCARAQKARBqC00AAAQQQQAABBBBAIIYAAUAMZepAAAEEEEAAAQQQQCARAQKARBqC00AAAQQQQAABBBBAIIYAAUAMZepAAAEEEEAAAQQQQCARAQKARBqC00AAAQQQQAABBBBAIIbAK6gErYlfl/S3AAAAAElFTkSuQmCC" /><!-- --></p>
</div>
<div id="querying" class="section level2">
<h2>Querying</h2>
<p><code>spectrolab</code> lets you query the <code>spectra</code> object and get summary infomation. You can easly get sample names with <code>names()</code> and wavelength labels with <code>wavelengths()</code>. It is also possible to recover the</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get the vector of all sample names</span>
<span class="co"># Note that duplicate sample names are permitted</span>
n =<span class="st"> </span><span class="kw">names</span>(spec)
n[<span class="dv">1</span>:<span class="dv">5</span>]

<span class="co"># Or get the vector of wavelengths</span>
w =<span class="st"> </span><span class="kw">wavelengths</span>(spec)
w[<span class="dv">1</span>:<span class="dv">5</span>]

<span class="co"># You can also get the dimensions of your `spectra` object</span>
<span class="kw">dim</span>(spec)</code></pre></div>
<p>If you need the reclectance, you can retrieve it with the <code>reflectance()</code> function.</p>
</div>
<div id="subsetting-spectra" class="section level2">
<h2>Subsetting spectra</h2>
<p>You can subset the <code>spectra</code> using a notation <em>similar</em> to the <code>[ i , j]</code> function used in matrices and data.frames. The first argument in <code>[ i, ]</code> matches <em>sample names</em>, whereas the second argument <code>[ , j ]</code> matches the <em>wavelength names</em>. Here are some examples of how <code>[</code> works in <code>specrta</code>:</p>
<ul>
<li><code>x[ 1:3 , ]</code> will keep the first three samples of <code>x</code>. I.e. <code>1:3</code> are indexes.</li>
<li><code>x[ &quot;sp_1&quot; , ]</code> keeps <strong>all</strong> entries in <code>x</code> where sample names match <code>&quot;sp_1&quot;</code></li>
<li><code>x[  , 800:900 ]</code> will keep wavelengths between <code>800</code> and <code>900</code>.</li>
<li><code>x[  , 1:5 ]</code> will <strong>fail</strong>!. <em>wavelengths <strong>cannot</strong> be subset by index!</em></li>
</ul>
<p>For example, I often want to exclude the noisy regions at the beginning and end of the spectrum and subset the data to specific entries.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Subset wavelength regions 
spec_clip &lt;-<span class="st">  </span>spec[ , <span class="dv">400</span>:<span class="dv">2400</span>]

### Check the result
<span class="kw">plot</span>(spec_clip)

<span class="co"># Subset spectra to all entries where sample_name matches &quot;species_8&quot; and wavelength regions </span>
spec_sp8 =<span class="st"> </span>spec[ <span class="st">&quot;species_8&quot;</span>, <span class="dv">400</span>:<span class="dv">2400</span>]

<span class="co"># Check the results</span>
<span class="kw">dim</span>(spec_sp8)

<span class="co"># Plotting the subset result should work just fine</span>
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">cex.main =</span> <span class="fl">0.8</span>, <span class="dt">cex.axis =</span> <span class="fl">0.6</span>, <span class="dt">cex.lab =</span> <span class="fl">0.8</span>)

<span class="kw">plot</span>(spec_sp8, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Species 8 spectra&quot;</span>)
<span class="kw">plot_quantile</span>(spec, <span class="dt">total_prob =</span> <span class="fl">1.0</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>,  <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>), <span class="dt">border =</span> <span class="ot">FALSE</span>)
<span class="kw">plot_spec_regions</span>(spec_sp8, <span class="kw">default_spec_regions</span>(), <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.1</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Note that you can (1) subset samples using indexes and (2) use character or numeric to subset wavelengths. As said before, you cannot use indexes to subset wavelengths though.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Subset samples by index should work. It is also OK to subset by wavelength </span>
<span class="co"># using numerics or characters.</span>
<span class="kw">reflectance</span>(spec_sp8[ <span class="dv">1</span> , <span class="st">&quot;405&quot;</span>]) ==<span class="st"> </span><span class="kw">reflectance</span>(spec_sp8[ <span class="dv">1</span> , <span class="dv">405</span>])</code></pre></div>
<pre><code>## Error in inherits(spec, &quot;spectra&quot;): object 'spec_sp8' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#</span>
<span class="co"># But remember that you CANNOT use indexes to subset wavelengths!</span>
<span class="co">#!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!#</span>

<span class="co"># Something that is obvioulsy an index, like using 2 instead of 401 (the 2nd band), will fail.</span>
spec_sp8[ , <span class="dv">2</span> ]</code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'spec_sp8' not found</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># However, `spectrolab` canot detect if you meant to get the two last bands when</span>
<span class="co"># you use 2000:2001. It will assume that you wanted wavelengths &quot;2000&quot; and &quot;2001&quot;</span>
<span class="co"># Bottomline, be very careful not to use indexes to subset wavelengths!</span></code></pre></div>
</div>
<div id="manipulating-samples-and-wavelength-labels" class="section level2">
<h2>Manipulating samples and wavelength labels</h2>
<p>You may want to edit certain simple attributes of <code>spectra</code>, such as make all sample names uppercase. This is easlily attainable in <code>spectrolab</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">spec_new =<span class="st"> </span>spec

<span class="co"># Replace names with an uppercase version</span>
<span class="kw">names</span>(spec_new) =<span class="st"> </span><span class="kw">toupper</span>(<span class="kw">names</span>(spec_new))

<span class="co"># Check the results</span>
<span class="kw">names</span>(spec_new)[<span class="dv">1</span>:<span class="dv">5</span>]</code></pre></div>
<p>You may want to fiddle with the reflectance itself. This is easy to do, but there are some constraints. For example, <code>spectrolab</code> will not allow you to have negative reflectance values or values greater than 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Scale reflectance by 0.75</span>
<span class="co"># spec_new[] = reflectance(spec_new) * 0.75</span>
spec_new =<span class="st"> </span>spec_new *<span class="st"> </span><span class="fl">0.75</span>

<span class="co"># Plot the results</span>
<span class="kw">plot</span>(spec, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.75</span>, <span class="dt">cex.axis =</span> <span class="fl">0.75</span>)
<span class="kw">plot</span>(spec_new, <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">lwd =</span> <span class="fl">0.75</span>, <span class="dt">add =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>However, <code>spectrolab</code> will throw an error if you try to perform an illegal operation to reflectance, for instance</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Trying to add 1.0 to all reflectance values will fail.</span>
spec_new[] =<span class="st"> </span><span class="kw">reflectance</span>(spec_new) +<span class="st"> </span><span class="fl">1.0</span></code></pre></div>
<pre><code>## Error in inherits(spec, &quot;spectra&quot;): object 'spec_new' not found</code></pre>
<div id="converting-a-spectra-object-into-a-matrix" class="section level3">
<h3>Converting a <code>spectra</code> object into a matrix</h3>
<p>It is possible to convert a <code>spectra</code> object to a matrix format, using the <code>as.matrix()</code> function. <code>spectrolab</code> will (1) place wavelengths in columns, assigning wavelength labels to <code>colnames</code>, and (2) samples in rows, assigning sample names to <code>rownames</code>. Since <code>R</code> imposes strict on column name formats and sometimes on row names, <code>as.matrix()</code> will try to fix potential dimname issues if <code>fix_names != &quot;none&quot;</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make a matrix from a `spectra` object</span>
spec_as_mat =<span class="st"> </span><span class="kw">as.matrix</span>(spec, <span class="dt">fix_names =</span> <span class="st">&quot;none&quot;</span>)
spec_as_mat[<span class="dv">1</span>:<span class="dv">4</span>, <span class="dv">1</span>:<span class="dv">3</span>]</code></pre></div>
<pre><code>##                  400        401        402
## species_7 0.08199857 0.08207722 0.08212993
## species_9 0.04100525 0.04104476 0.04107129
## species_8 0.04100168 0.04104095 0.04106724
## species_7 0.04099856 0.04103779 0.04106406</code></pre>
</div>
</div>
<div id="excluding-bad-spectra" class="section level2">
<h2>Excluding bad spectra</h2>
<p>The <code>spectrolab</code> package comes with a couple of functions to exclude bad spectra. However, thus far the functions only accept data.frames, such as Acer_juco, the result from the initial jump correction. At this point, a typical workflow would involve inspecting the raw spectra with <code>plot_rawspec</code>, removing bad spectra, and plotting again, until the output looks fine. Then a <code>spectra</code> object can be constructed with <code>as.spectra</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">### Some common examples, see `excl.` for more.
### Exclude spectra with reflectances at the 'NIR shoulder' @ 761 nm &lt;0.3 or &gt;0.65 
Acer_excl &lt;-<span class="st"> </span><span class="kw">exclhilo_spec</span>(Acer_juco)

### Exclude spectra with high reflectances in VIS: @ 450 nm &gt;0.2 
Acer_excl &lt;-<span class="st"> </span><span class="kw">exclhivis_spec</span>(Acer_juco)

### Exclude spectra with dips in NIR: @800 - @770 &gt;0.02 ###
Acer_excl &lt;-<span class="st"> </span><span class="kw">excldipnir_spec</span>(Acer_juco)

### Create spectra object and plot
Acer_corr &lt;-<span class="st"> </span><span class="kw">as.spectra</span> (Acer_excl)
<span class="kw">plot</span>(Acer_corr)</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
